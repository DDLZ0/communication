通信基本概念
============

![](media/image1.jpeg){width="5.768055555555556in"
height="4.442361111111111in"}

基本名词
========

  -------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
  **名词**   **解释**
  ---------- --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
  SCI        串行通信的总称，可以包括串行同步通信SPI，也可以包括串行异步通信Uart, 区别于并行通信，表示一个字节一个字节的依次传输

  Uart       通用异步收发器，是串行通信的一种通信协议，规定了串行通信的波特率、起始/停止位、数据位、校验位等格式，以及各种异步握手信号（0，1信号）；
             
             通信双方只要采用相同的帧格式和波特率，就能在未共享时钟信号的情况下，仅用仅用两根信号线（Rx 和Tx）就可以完成通信过程

  RS232      物理接口电气标准，规定传输介质（电缆）、收发电平等。都是SCI，通信协议相同（都是Uart，只有波特率、起始/停止位、数据位、校验位等参数），仅传输介质和收发电平不同。
             
  RS485      TTL型传输的uart，高电平最高为5V，低电平最低为0V，传输距离比较近；
             
  RS422      RS232传输的uart，高电平最高为25V，低电平最低为-25V，传输距离中等；
             
             RS485传输的uart，高电平最高为12V，低电平最低为-7V，传输距离最远；

  异步通信   通信中2个字符（8位（数据位构成一个字符））之间的时间是不固定的，而在一个字符内各位的时间间隔是固定的；
             
             异步通信是按字符传输的，接收设备在收到起始信号之后只要在一个字符的传输时间内能和发送设备保持同步就能正确接收。下一个字符起始位的到来又使同步重新校准（依靠检测起始位来实现发送与接收方的时钟自同步的）
  -------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------

通信协议
========

+-----------------------+-----------------------+-----------------------+
| **通信协议**          | **基本介绍**          | **数据格式**          |
+=======================+=======================+=======================+
| Uart                  | 1.  串行数据总线，用于**串行异步** | ![](media/image2.png) |
|                       | 通信；                | {width="1.75135170603 |
|                       |                       | 67454in"              |
|                       | 2.  该总线双向通信，可以实现全双工传输 | height="0.63194444444 |
|                       | 和接收，（TX、RX）；  | 44444in"}             |
|                       |                       |                       |
|                       | 3.  串行通信即将传输的数据帧的一位一位 | 带有格式信息的数据字符叫帧，一帧包含1位启 |
|                       | 的传输；              | 动位、1\~8位数据、1或2位停止位、可选 |
|                       |                       | 择的奇偶校验位        |
+-----------------------+-----------------------+-----------------------+
| CAN                   | 1.  用于实时应用的的**串行通讯协议* | **1.发送过程：** |
|                       | *总线，它可以使用**双绞线**来传输信号 |       |
|                       | ，是世界应用最广的**现场总线**之一； | ![](media/image5.png) |
|                       |                       | {width="2.91666666666 |
|                       |                       | 66665in"              |
|                       | 2.  **半双工**；      | height="1.12090004374 |
|                       |                       | 4532in"}              |
|                       | 3.  采用数据位仲裁方式代替传统的地址轮 |      |
|                       | 询方式，因此可以支持多主多从的工作方式 | CAN控制器将CPU传来的信号转为逻辑电平 |
|                       |                       | （0或1），CAN发送器接收到逻辑电平后， |
|                       |                       | 再将其转换为差分信号输出到CAN总线上； |
|                       | 4.  CAN控制器根据两根总线上的**电 |           |
|                       | 位差**来判断总线电平。总线电平分为显性电 |    |
|                       | 平（逻辑0）和隐性电平（逻辑1）。显性电平 | **2.接收过程：** |
|                       | 对应逻辑电平为0，CAN-H与CAN-L之 |             |
|                       | 间的差为2.5V左右；隐性电平对应逻辑电平 | ![](media/image6.png) |
|                       | 为1，CAN-H与CAN-L之间的差为0V | {width="2.53639216972 |
|                       | 左右；在总线上**显性电平具有优先权**， | 8784in" |
|                       | 只要有一个单元输出显性电平，总线上即为显性 | height="1.42234142607 |
|                       | 电平。(CAN\_High、CAN\_Lo | 1741in"}          |
|                       | w)                    |                       |
|                       |                       | CAN接收器将CAN\_H和CAN\_L线 |
|                       | 5.  一个邮箱数据最大为8个字节（64位 | 上传来的差分电平转换成逻辑电平输出给CAN |
|                       | ），分高、低2个邮箱   | 控制器，CAN控制器再把逻辑电平转成相应信 |
|                       |                       | 号给CPU               |
|                       | 为了更有效的控制通信，CAN一共规定了5种 |      |
|                       | 类型的帧（报文）      | 1.  CAN的报文种类及结构 |
|                       |                       |                       |
|                       | ![](media/image3.png) |                       |
|                       | {width="3.65799321959 | 当使用CAN协议进行通讯时，需要对数据、操 |
|                       | 755in"                | 作命令(如读/写)以及同步信号进行打包，打 |
|                       | height="1.43125in"}   | 包后的这些内容称为报文。 |
|                       |                       |                       |
|                       | 数据帧：标准数据帧和扩展数据帧 |              |
|                       |                       | **（1）数据帧：**以一个显性位（逻辑0 |
|                       |                       | ）开始，以连续7个隐形位（逻辑1）结束。在 |
|                       | ![](media/image4.png) | 他们之间，分别有**仲裁段**、**控制段 |
|                       | {width="3.81388888888 | **、**数据段**、**CRC段**和* |
|                       | 8889in"               | *ACK段**。            |
|                       | height="1.84158464566 |                       |
|                       | 92913in"}             | **1）帧起始：**SOF段，1位，显性位 |
|                       |                       | （逻辑0），它用于通知各个节点将有数据传输 |
|                       |                       | ，其他节点通过帧起始信号的电平跳变沿来进行 |
|                       |                       | 硬同步；              |
|                       |                       |                       |
|                       |                       | **2）仲裁段：**包括2部分：本数据帧的 |
|                       |                       | **ID信息（标识符）**和远程发送请求位 |
|                       |                       | **RTR；**             |
|                       |                       |                       |
|                       |                       | **ID标识符：**        |
|                       |                       |                       |
|                       |                       | 当同时有两个报文被发送时，总线会根据**仲 |
|                       |                       | 裁段的ID信息决定**哪个数据能被传输； |
|                       |                       |                       |
|                       |                       |                       |
|                       |                       | 数据帧具有标准格式和扩展格式两种，区别在I |
|                       |                       | D标识符的长度上，标准格式的ID为**11 |
|                       |                       | 位**，扩展格式的ID为**29位**； |
|                       |                       |                       |
|                       |                       |                       |
|                       |                       | CAN协议中，ID起着重要作用，它决定数据 |
|                       |                       | 帧发送的优先级，也决定着其他节点是否接收这 |
|                       |                       | 个数据帧。            |
|                       |                       |                       |
|                       |                       | **报文的优先级**，是通过对ID的仲裁来 |
|                       |                       | 确定的。根据前面对物理层的分析我们知道如果 |
|                       |                       | 总线上同时出现显性电平和隐性电平，总线的状 |
|                       |                       | 态会被置为显性电平，CAN正是利用这个特性 |
|                       |                       | 进行仲裁。            |
|                       |                       |                       |
|                       |                       | ![](media/image7.png) |
|                       |                       | {width="2.77067585301 |
|                       |                       | 83726in"              |
|                       |                       | height="1.03960411198 |
|                       |                       | 60018in"}             |
|                       |                       |                       |
|                       |                       | CAN总线上数据是以广播的形式发送的，所有 |
|                       |                       | 连接在CAN总线的节点都会收到其他节点所发 |
|                       |                       | 送的有效数据，CAN控制器具有**ID过滤 |
|                       |                       | 报文**的功能，只接受与自己匹配的某些报文 |
|                       |                       | 。                    |
|                       |                       |                       |
|                       |                       | **远程发送请求位RTR：** |
|                       |                       |                       |
|                       |                       |                       |
|                       |                       | **1位，**用来区分数据帧（显性位）和遥 |
|                       |                       | 控帧（远程帧，隐形位）； |
|                       |                       |                       |
|                       |                       |                       |
|                       |                       | **3）控制段：**共6bit，分别是** |
|                       |                       | 扩展标识符IDE**（1位）、保留位R0（ |
|                       |                       | 1位）、**数据长度编码位**DLC（4位 |
|                       |                       | ）；                  |
|                       |                       |                       |
|                       |                       | **4）数据段：**数据段为数据帧的核心内 |
|                       |                       | 容，它是节点要发送的原始信息，由**0\~ |
|                       |                       | 8个字节**组成，**MSB**先行； |
|                       |                       |                       |
|                       |                       |                       |
|                       |                       | **5）循环校验段CRC**：包括15bi |
|                       |                       | t的CRC序列和1bit的界定符DEL（表 |
|                       |                       | 示循环校验序列结束）  |
|                       |                       |                       |
|                       |                       | **CRC序列**           |
|                       |                       |                       |
|                       |                       | 一旦接收节点算出的CRC码跟接收到的CRC |
|                       |                       | 码不同，则它会向发送节点反馈出错信息，利用 |
|                       |                       | **错误帧**请求它重新发送。CRC部分的 |
|                       |                       | 计算一般由CAN控制器硬件完成，出错时的处 |
|                       |                       | 理则由软件控制最大重发数。在CRC校验码之 |
|                       |                       | 后，有一个CRC界定符， |
|                       |                       |                       |
|                       |                       | **CRC界定符DEL**      |
|                       |                       |                       |
|                       |                       | 为隐性位，主要作用是把CRC校验码与后面的 |
|                       |                       | ACK段间隔起来，表示循环校验序列结束； |
|                       |                       |                       |
|                       |                       |                       |
|                       |                       | **6）确认段ACK**：包括1bit的A |
|                       |                       | CK槽位和1bit的ACK界定符位 |
|                       |                       |                       |
|                       |                       |                       |
|                       |                       | 在ACK槽位中，发送节点发送的是隐性位，而 |
|                       |                       | 接收节点则在这一位中发送显性位以示应答。在 |
|                       |                       | ACK槽和帧结束之间由ACK界定符间隔开； |
|                       |                       |                       |
|                       |                       |                       |
|                       |                       | **7）帧结束EOF**：由发送节点发送的 |
|                       |                       | 7个隐性位表示结束。   |
|                       |                       |                       |
|                       |                       | **（2）远程帧：**通过发送远程帧，作为 |
|                       |                       | 数据接收器的节点可以发起各自数据源的数据传 |
|                       |                       | 送清求，即向数据发送器请求发送具有相同id |
|                       |                       | 的数据帧；            |
|                       |                       |                       |
|                       |                       | 选程帧包括帧开始、    |
|                       |                       | 仲裁段、控制段、CRC段、ACK段和帧结束 |
|                       |                       | 。远程帧没有数据段；  |
|                       |                       |                       |
|                       |                       | **（3）错误帧**：有两种错误标志:主动 |
|                       |                       | (正）错误标志和被动（负）错误标志。活动错 |
|                       |                       | 误标志：由6个连续的显示位组成。 |
+-----------------------+-----------------------+-----------------------+
| SPI                   | 1.  **全双工**短距离单主设备通信协 | ![](media/image8.png) |
|                       | 议，与Uart不同，他是**串行同步通信* | {width="3.37925087489 |
|                       | *协议；               | 06385in"              |
|                       |                       | height="0.70394685039 |
|                       | 2.  连接方式之一：主从连接。 | 37008in"}      |
|                       |                       |                       |
|                       |                       | **1.接口：四根线**    |
|                       | 3.  支持一主多从。在SPI总线上，某时 |         |
|                       | 刻可以出现多个从机，但只能存在一个主机，主 | SCL：串行时钟，用来同步数据传输，由主机 |
|                       | 机通过片选信号来确定要通信的从机，这就要求 | 输出； |
|                       | 从机的MISO口具有三态性，使得该口在器件 |      |
|                       | 未被选中时表现为高阻态 | MISO：主入从出；     |
|                       |                       |                       |
|                       |                       | MOSI：主出从入        |
|                       | 4.  可以同时发送和接收数据。发送的数据 |      |
|                       | 先到发送数据缓冲区，再到移位寄存器中按位传 | CS/SS：片选信号，低电平有效，由主机输 |
|                       | 送，数据都是以字节为单位，高位优先。 | 出     |
|                       |                       |                       |
|                       |                       | **2.传输方式**        |
|                       | 5.  SPI通信传输过程其实就是主、从设 |         |
|                       | 备数据交换的一个过程，MOSI | ![](media/image9.png) |
|                       |                       | {width="3.03289479440 |
|                       |     和                | 07in"                 |
|                       |     MISO在一个时钟周期内都会进行数 | height="1.42638888888 |
|                       | 据位的发送和接收，如果不需要接收的数据，直 | 8889in"} |
|                       | 接忽略就可以了，不做处理。 |                  |
|                       |                       | 一个SPI时钟周期内，会完成： |
|                       |                       |                       |
|                       | 6.  四种工作模式。时钟极性（CKP/C |           |
|                       | POL）和时钟相位（CKE/CPHA）共同 | 主机通过MOSI线发送一位数据，从机通过该 |
|                       | 决定SPI读取数据的模式。 | 线读取这一位数据；  |
|                       |                       |                       |
|                       |                       | 从机通过MISO线发送一位数据，主机通过该 |
|                       | > **时钟极性**：设为“0”表示空闲状 | 线读取这一位数据。 |
|                       | 态时钟为低电平，      |                       |
|                       | >                     | 这是通过移位寄存器来实现的。主机和从机各有 |
|                       | > 设为“1”表示空闲状态时钟为高电平； | 一个移位寄存器，且二者连接成环。随着时钟脉 |
|                       |                       | 冲，数据按照从高到低的方式依次移出主机寄存 |
|                       | >                     | 器和从机寄存器，并且依次移入从机寄存器和主 |
|                       | > **时钟相位**：设为"0"表示在时钟 | 机寄存器。当寄存器中的内容全部移出时，相当 |
|                       | 信号的第一个跳变沿采样； | 于完成两个寄存器内容的交换。 |
|                       |                       |                       |
|                       | >                     |                       |
|                       | > 设为"1"表示在时钟信号的第二个跳变沿 | **3.工作模式：** |
|                       | 采样；                |                       |
|                       | >                     | ![](media/image10.png |
|                       | > **模式0 (CPOL =     | ){width="2.3725667104 |
|                       | > 0,CPHA = 0)：**     | 111987in"             |
|                       | >                     | height="1.02702646544 |
|                       | > 在空闲状态下，SCLK处于低电平，在第 | 18197in"}![](media/im |
|                       | 1个时钟边沿（跳变）进行数据采样，采样完在 | age11.png){width="2.0 |
|                       | 下一个跳变沿发送数据。 | 096128608923887in"   |
|                       |                       | height="0.97837926509 |
|                       | >                     | 18636in"}             |
|                       | > **模式1 (CPOL =     |                       |
|                       | > 0,CPHA = 1)**       | ![](media/image12.png |
|                       | >                     | ){width="2.4196237970 |
|                       | > 在空闲状态下，SCLK处于低电平，在第 | 25372in" |
|                       | 2个时钟边沿进行数据采样，第一个时钟沿进行 | height="1.17297353455 |
|                       | 发送数据              | 81802in"}![](media/im |
|                       | >                     | age13.png){width="2.2 |
|                       | > **模式2 (CPOL =     | 936253280839893in"    |
|                       | > 1,CPHA = 0)**       | height="1.20540573053 |
|                       | >                     | 36834in"}             |
|                       | > 在空闲状态下，SCLK处于高电平，在第 |        |
|                       | 1个时钟边沿进行数据采样，采样完在下一个跳 |   |
|                       | 变沿发送数据。        |                       |
|                       | >                     |                       |
|                       | > **模式3 (CPOL =     |                       |
|                       | > 1,CPHA = 1)**       |                       |
|                       | >                     |                       |
|                       | > 在空闲状态下，SCLK处于高电平，在第 |        |
|                       | 2个时钟边沿进行数据采样，第一个时钟沿进行 |   |
|                       | 发送数据。            |                       |
+-----------------------+-----------------------+-----------------------+
| I2C                   | 1.  两条线连接的**半双工**协议（数 | **1.数据格式：** |
|                       | 据线：SDA、时钟线：SCL）； |                  |
|                       |                       | 每个字节必须是8位，最后一位为响应位； |
|                       |                       |                       |
|                       | 2.  **串行同步通信；** |                      |
|                       |                       | 每次传输可以发送的字节数量不受限制； |
|                       |                       |                       |
|                       | 3.  总是要通过电阻上拉至输入电压，工作 |      |
|                       | 于三种速度：高速、快速、慢速； | 最开始发送的是从机地址 |
|                       |                       |                       |
|                       |                       |                       |
|                       | 4.  每个连接到总线上的器件都有**唯一 | ![](media/image14.png |
|                       | 的地址**，任何器件既可以作为主机也可以作 | ){width="4.1942618110 |
|                       | 为从机，但同一时刻只允许有一个主机 | 23622in" |
|                       |                       | height="0.97010170603 |
|                       |                       | 67454in"}             |
|                       | 5.  传输方式：        |                       |
|                       |                       | **2.应答响应：**      |
|                       | > 1)如果主机要发送数据给从器件，则主机 |      |
|                       | 首先寻找从器件，然后主动发送数据至从器件， | **地址匹配**完成就会得到响应信号（AC |
|                       | 最后由主机终止数据传输； | K），说明从设备存在； |
|                       |                       |                       |
|                       | >                     | **开始信号**：主机让时钟SCL保持高电 |
|                       | > 2)                  | 平，数据SDA由高电平跳到低电平； |
|                       | > 如果主机要接收从器件的数据，首先由主机 |    |
|                       | 寻找从器件，然后主机接收从器件发送的数据， |  |
|                       | 最后由主机终止接收过程。这种情况下，主机负 | **停止信号**：主机让时钟SCL保持高电 |
|                       | 责产生定时时钟和终止数据传送； | 平，数据SDA由低电平跳到高电平； |
|                       |                       |                       |
|                       |                       |                       |
|                       |                       | **响应信号**（ACK）：接收器在接收到 |
|                       |                       | 8位数据后，在第9个时钟周期拉低SDA为低 |
|                       |                       | 电平；                |
|                       |                       |                       |
|                       |                       | SDA上传输的数据必须在SCL为高电平的期 |
|                       |                       | 间保持稳定，外部设备会在SCL为高电平时读 |
|                       |                       | 取数据；              |
|                       |                       |                       |
|                       |                       | SDA的数据只能在SCL为低电平期间发生变 |
|                       |                       | 化。                  |
+-----------------------+-----------------------+-----------------------+
| Arinc429              | 1.  数据总线，民用飞机机载总线规范； | **1.数据：** |
|                       |                       |                       |
|                       |                       | ARINC-429通信采用带有**奇偶校验 |
|                       | 2.  是一种**串行标准**，为面向接口 | 的32位信息字**，采用双极性归零码的三态 |
|                       | 型的**单向广播式**传输总线。该总线上只 | 调制编码方式，调制信号由“高”、“零”、“ |
|                       | 允许有一个发送器，但可以有多个接收器（最多 | 低”三种电平状态。 |
|                       | 为20个）。            |                       |
|                       |                       | 接收器输入端（考虑到干扰情况下）： |
|                       | 3.  以**差动输出**的对称(平衡)方 |            |
|                       | 式工作。              |                       |
|                       |                       | 高电平为+6.5V\~+13V； |
|                       | 4.  采用**双绞屏蔽线异步**传输数据 |          |
|                       | 。                    | 零电平为- 2.5V\~ +    |
|                       |                       | 2.5V；                |
|                       | 5.  总线用**标志码字**来区分设备和 |          |
|                       | 信号名称              | 低电平为-6.5V\~-13V。 |
|                       |                       |                       |
|                       | 6.  速率为12. 5 kbps  | 数据传输中，发送端以足够高的速率传输数据， |
|                       |     或100             | 按开环方式控制传输，不需要接收器通知发送器 |
|                       |     kbps，通常以脉冲形式发送。 | 已接收到信息。 |
|                       |                       |                       |
|                       |                       | **2.总线规范**        |
|                       |                       |                       |
|                       |                       | 每个字格式由**32位**组成。 |
|                       |                       |                       |
|                       |                       |                       |
|                       |                       | 在连续传输的字与字之间至少有4个位的时间间 |
|                       |                       | 隔。                  |
|                       |                       |                       |
|                       |                       | 对于每一个字的同步，可通过检测每个字第一位 |
|                       |                       | 的跃变来实现。        |
|                       |                       |                       |
|                       |                       | 在发送每组数据后有四位零周期，它是隔离符号 |
|                       |                       | ，以便于发送下一组数据 |
|                       |                       |                       |
|                       |                       |                       |
|                       |                       | ![](media/image15.png |
|                       |                       | ){width="3.7297287839 |
|                       |                       | 020123in"             |
|                       |                       | height="0.56705380577 |
|                       |                       | 42782in"}             |
|                       |                       |                       |
|                       |                       | **数据传输顺序**：\   |
|                       |                       | 7,6,5,4,3,2,1,0,\     |
|                       |                       | 8,9,10,11,12……29,30,3 |
|                       |                       | 1                     |
|                       |                       |                       |
|                       |                       | 数据字主要包括五部分: |
|                       |                       |                       |
|                       |                       | **（1）标号( LABEL)** |
|                       |                       | 占8位（0bit-7bit）    |
|                       |                       |                       |
|                       |                       | 信息标识符，标号用**八进制**表示。 |
|                       |                       |                       |
|                       |                       |                       |
|                       |                       | 它标记出包括在这个传送字内的信息的类型，也 |
|                       |                       | 就是传送的代码的意义是什么。 |
|                       |                       |                       |
|                       |                       |                       |
|                       |                       | 如传送的是VHF信息，则标号为八进制数03 |
|                       |                       | 0；                   |
|                       |                       |                       |
|                       |                       | 若是DME数据，则标号为八进制数201等 |
|                       |                       |                       |
|                       |                       |                       |
|                       |                       | **标号位发送数据顺序与正常顺序相反, |
|                       |                       |                       |
|                       |                       | 先发送高字位再发送低字位**。 |
|                       |                       |                       |
|                       |                       |                       |
|                       |                       | **（2）源/ 目的标识(  |
|                       |                       | SDI)**                |
|                       |                       | 占2位（8bit-9bit）    |
|                       |                       |                       |
|                       |                       | 它指示信息的来源或信息的终端。 |
|                       |                       |                       |
|                       |                       |                       |
|                       |                       | 当需要将一些专用字传输到一个多系统的特定系 |
|                       |                       | 统时，就可以用来识别字的目的地址。也可以根 |
|                       |                       | 据字内容来判明一个多系统的原系统。 |
|                       |                       |                       |
|                       |                       |                       |
|                       |                       | **（3）数据组(DATA)** |
|                       |                       | 占19位（10bit-28bit） |
|                       |                       |                       |
|                       |                       | 根据字的类型可确定为是18还是19位。 |
|                       |                       |                       |
|                       |                       |                       |
|                       |                       | 它所代表的是所确定的特定数据。如标号为03 |
|                       |                       | 0，则10到28位为频率数据，使用的是** |
|                       |                       | BCD编码数据格式**。   |
|                       |                       |                       |
|                       |                       | **（4）符号/状态位(SSM)** |
|                       |                       |                       |
|                       |                       | 占2位（29bit-30bit）  |
|                       |                       |                       |
|                       |                       | 根据字的类型号可确定为28到29到31。 |
|                       |                       |                       |
|                       |                       |                       |
|                       |                       | 它指出数据的特性，如方向、符号等（南，北， |
|                       |                       | 正，负）。            |
|                       |                       |                       |
|                       |                       | ![](media/image16.png |
|                       |                       | ){width="1.7628532370 |
|                       |                       | 953631in"             |
|                       |                       | height="0.63748468941 |
|                       |                       | 38233in"}             |
|                       |                       | ![](media/image17.png |
|                       |                       | ){width="1.7945942694 |
|                       |                       | 663166in"             |
|                       |                       | height="0.63718613298 |
|                       |                       | 33771in"}             |
|                       |                       |                       |
|                       |                       | **（5）奇偶校验位(P)** |
|                       |                       |                       |
|                       |                       | 占1位（31bit）        |
|                       |                       |                       |
|                       |                       | 用于检查发送的数据是否有效。 |
|                       |                       |                       |
|                       |                       |                       |
|                       |                       | ![](media/image18.png |
|                       |                       | ){width="3.8712773403 |
|                       |                       | 324583in"             |
|                       |                       | height="1.24538276465 |
|                       |                       | 44182in"}             |
+-----------------------+-----------------------+-----------------------+
|                       |                       |                       |
+-----------------------+-----------------------+-----------------------+

CAN 的帧格式：

![](media/image19.png){width="4.657638888888889in"
height="5.248319116360455in"}

常见通信方式
============

  --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
  **通信**   **通信**           **接口/传输方式**                                                                     **传输距离**                                     **传输速度**                                                                               **优点**                                                                                **缺点**                                                                                  **备注**
                                                                                                                                                                                                                                                                                                                                                                                                                                                    
  **类别**   **协议**                                                                                                                                                                                                                                                                                                                                                                                                                               
  ---------- ------------------ ------------------------------------------------------------------------------------- ------------------------------------------------ ------------------------------------------------------------------------------------------ --------------------------------------------------------------------------------------- ----------------------------------------------------------------------------------------- ------------------------------------------------------------------------------------------------------------------------------------------------------------------------
  RS232      Uart               ![](media/image20.png){width="1.2304593175853018in" height="0.42857174103237095in"}   最大50m                                          20Kbps                                                                                     全双工效率高                                                                            传输距离短，抗干扰差容易产生共模干扰                                                      1.一对一通信
                                                                                                                                                                                                                                                                                                                                                                                                                                                    
             串行异步通信       三根线，TX、RX、GND，**全双工**                                                                                                                                                                                                                                                                                                                                                                                     2.不可以与TTL兼容

  RS485      Uart               ![](media/image21.png){width="1.1405413385826773in" height="0.6218011811023622in"}    []{#_Hlk127701658 .anchor}比RS232长，最大1200m   最高传输速度10Mbps,但是速度越高，传输距离越短，所以往往设为9600bps                         传输距离长，多节点，差分信号抗干扰强，**工业应用首选**                                  半双工效率低                                                                              1.RS485牺牲了232全双工的效率来达到远距离传输；
                                                                                                                                                                                                                                                                                                                                                                                                                                                    
             串行异步通信       差分信号，+-两根线，**半双工**                                                        (9600bps)                                                                                                                                                                                                                                                                                                                     2.可以一对一，也可以一对多
                                                                                                                                                                                                                                                                                                                                                                                                                                                    
                                                                                                                                                                                                                                                                                                                                                                                                                                                    3.可以与TTL兼容

  RS422      Uart               ![](media/image22.png){width="1.408332239720035in" height="0.6056408573928259in"}                                                                                                                                                 全双工效率高，传输距离长                                                                线太多，问答式（一问一答）通信体现不出优势                                                既像232一样全双工，又像485有较远的传输距离
                                                                                                                                                                                                                                                                                                                                                                                                                                                    
             串行异步通信       **2个485**，4根线，**全双工**                                                                                                                                                                                                                                                                                                                                                                                       

  CAN        CAN                ![](media/image23.png){width="2.186567147856518in" height="1.2756944444444445in"}     通信距离远                                       通信速度快，                                                                               多节点，通信距离远，通信速度快，具有错误检测、错误通知、错误恢复功能，抗干扰性强        1.半双工效率低；                                                                          多主控制：在总线空闲时，所有单元都可以发送信息，而两个以上单元同时发送信息时，根据标识符（ID）决定优先级，优先级高的单元可以继续发送信息，其他单元停止发送转为接受工作
                                                                                                                                                                                                                                                                                                                                                                                                                                                    
             串行异步通信       由控制器和收发器组成，                                                                最远10km（速率低于5kbps）,                       最高1Mbps，通常500kbps、250kbps                                                                                                                                                    2.长数据传输时数据负载偏低（以扩展帧为例，其29位ID和64位的数据，导致数据承载只有60%）；   
                                                                                                                                                                                                                                                                                                                                                                                                                                                    
                                双绞线，差分信号CAN\_High、CAN\_Low，**半双工**                                       最短小于40m(通信速率1Mbps)                                                                                                                                                                                                          3\. 长数据（大于8字节）传输分帧丢帧，会导致整包传输失败。                                 

  SPI        SPI                ![](media/image24.png){width="2.0210772090988627in" height="1.086486220472441in"}     可靠传输距离一般为1-3米，                        速度比I2C快；                                                                              全双工；                                                                                占用主机较多的口线（每个从机需要一根片选线）；                                            驱动能力有限，一般不超过10个
                                                                                                                                                                                                                                                                                                                                                                                                                                                    
             **串行同步**通信   4根线，有一个时钟信号，**全双工**                                                                                                      SPI是一种事实标准，由Motorola开发，并没有一个官方标准。已知的有的器件SPI已达到**50Mbps**   简单的软件配置；                                                                        只支持单主机；                                                                            
                                                                                                                                                                                                                                                                                                                                                                                                                                                    
                                                                                                                                                                                                                                                                  数据传输速率较高；                                                                      没有应答机制确认是否接收到数据；                                                          
                                                                                                                                                                                                                                                                                                                                                                                                                                                    
                                                                                                                                                                                                                                                                  数据传输大小可任意配置                                                                  传输距离短                                                                                

  Arinc429   Arinc429           **差分信号，全双工**                                                                  传输距离较远，最远几百米                         速率为12. 5 kbps 或100 kbps，                                                              结构简单、性能稳定、抗干扰性强；                                                                                                                                                  
                                                                                                                                                                                                                                                                                                                                                                                                                                                    
             **串行异步**通信                                                                                                                                                                                                                                     最大的优势是可靠性高，这是由于非集中控制、传输可靠、错误隔离性好                                                                                                                  

  I2C        I2C                ![](media/image25.png){width="2.0373906386701663in" height="0.9094783464566929in"}    近距离，总线仲裁机制                             没有严格的波特率要求；                                                                     所有组件之间都存在简单的主/从关系，连接到总线的每个设备均可通过唯一地址进行软件寻址；   半双工效率低；                                                                            1.I2C具有冲突检测机制和仲裁机制的真正意义上的**多主机总线**，它能在多个主机同时请求控制总线时利用仲裁机制避免数据冲突并保护数据。
                                                                                                                                                                                                                                                                                                                                                                                                                                                    
             **串行同步通信**   一根时钟线和一根数据，半双工                                                                                                           传输速度四种模式：                                                                         I2C是真正的多主设备总线，可提供仲裁和冲突检测；                                         距离短，适合电路板上的通讯                                                                2\. 最大主设备数：无限制；
                                                                                                                                                                                                                                                                                                                                                                                                                                                    
                                                                                                                                                                       标准模式：100 Kbps                                                                         传输速度分为四种模式：                                                                                                                                                            最大从机数：理论上是127。
                                                                                                                                                                                                                                                                                                                                                                                                                                                    
                                                                                                                                                                       快速模式：400 Kbps                                                                                                                                                                                                                                                           
                                                                                                                                                                                                                                                                                                                                                                                                                                                    
                                                                                                                                                                       高速模式：3.4 Mbps                                                                                                                                                                                                                                                           
                                                                                                                                                                                                                                                                                                                                                                                                                                                    
                                                                                                                                                                       超快速模式：5 Mbps                                                                                                                                                                                                                                                           
  --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------

总结：

**速度上：SPI &gt; I2C≈CAN &gt; UART**

**I2C总线速度一般普遍慢于SPI**，I2C一般的速度是100kbs、400kbps和1Mbps，而SPI的速度可以在几Mbps，也可以10+Mbps。UART和SPI、I2C不同，他是异步传输的，一般来说传输速度比较慢，传统的传输速度一般在115200bps或以下。

CAN和I2C看不同场景，差不多。

**距离上：RS485 &gt; RS232 &gt; CAN &gt; SPI &gt; I2C**

RS485比RS232长，最大1200m(9600bps)，RS232是50m，CAN的距离一般为40m以内（提高传输速度），SPI为1-3米，I2C一般用作板件通讯，如E2PROM、传感器等。

ARINC825

RS-232

RS-232是一种串行物理接口标准，是对电气特性以及物理特性的规定，只作用于数据的传输通路上，它并不内含对数据的处理方式。需要说明一下,很多人经常把RS-232、RS-422、RS-485
误称为通讯协议,这是很不应该的，其实它们仅是关于UART通讯的一个机械和电气接口标准（顶多是网络协议中的物理层面）。

 嵌入式里面说的串口，一般是指UART口，
但是我们经常搞不清楚它和COM口的区别,  以及RS232, TTL等关系,
 实际上UART,COM指的物理接口形式(硬件),
而TTL、RS-232是指的电平标准(电信号)
